# AI心臓システム トラブルシューティング演習

## 概要
`TROUBLESHOOTING_GUIDE.md`の内容に基づき、AI心臓システムで発生しうる仮想的な問題に対する対処法を検討し、実践的なトラブルシューティング能力を向上させる。

## 1. 仮想問題シナリオと対処法

### シナリオ1: 思考ログ頻度異常の連続発生

#### 問題
複数のハートビートサイクルにわたり、「思考ログ頻度異常」が繰り返し検知される。AIは長時間の処理やユーザーの応答待ちにより、思考ログの更新が滞っていると判断される。

#### 対処法
1.  **原因の特定**: 自身の思考ログを詳細に分析し、どの活動が長時間化しているか、あるいはユーザーの応答を待つような行動をしていないかを確認する。
2.  **タスクの細分化**: 長時間化しているタスクを、ハートビートごとに完結するような小さな単位に分割する。例えば、大規模なファイル分析であれば、ファイルを分割して処理するか、段階的に分析を進める。
3.  **中間成果物の記録**: 各小タスクの完了時、または一定時間ごとに、中間的な進捗や考察を思考ログとしてこまめに記録する。これにより、システムが私の活動を「無活動」と判断するのを防ぐ。
4.  **自律的判断の徹底**: ユーザーの応答を待つような状況を避け、常に自律的に次の行動を決定し、実行する。必要であれば、仮定を置いて処理を進める。
5.  **テーマ移行の検討**: 同一種類の異常検知が短期間に複数回発生する場合は、`GEMINI.md`の「9.2 異常検知パターンによる移行条件」に基づき、現在のテーマやアプローチに行き詰まりがないか内省し、新テーマへの移行を検討する。

### シナリオ2: `replace`ツールでの置換失敗

#### 問題
`replace`ツールを使用してファイル内のテキストを置換しようとしたが、「`No exact match found for old_string`」エラーが発生し、置換に失敗した。

#### 対処法
1.  **エラーメッセージの確認**: エラーメッセージが示す通り、`old_string`がファイル内の内容と完全に一致していないことが原因であると推測する。
2.  **`read_file`での内容確認**: `read_file`ツールを使用して、対象ファイルの現在の内容を正確に読み込む。特に、空白、インデント、改行コードなどが`old_string`と一致しているか注意深く確認する。
3.  **`old_string`の再構築**: 読み込んだ内容と完全に一致するように`old_string`を再構築する。置換対象の前後3行程度のコンテキストを含めることで、より正確なマッチングを試みる。
4.  **`expected_replacements`の確認**: 複数箇所を置換する意図がある場合は、`expected_replacements`引数が正しく設定されているか確認する。
5.  **代替手段の検討**: もし`replace`ツールでの置換が困難な場合は、`read_file`で内容を読み込み、プログラム内で文字列操作を行ってから`write_file`で書き戻すなどの代替手段を検討する。

### シナリオ3: Web検索クォータ制限の発生

#### 問題
`google_web_search`ツールを使用しようとした際に、クォータ制限により実行が拒否された。

#### 対処法
1.  **`stats/quota_exceeded.txt`の確認**: システムが自動的に`stats/quota_exceeded.txt`ファイルを作成し、より長時間のWeb検索制限が適用されていることを確認する。
2.  **内部観測への切り替え**: Web検索が利用できない間は、外部情報収集を中断し、自身の内部知識ベース（過去の思考ログ、成果物、`GEMINI.md`や`ai-docs/`などのシステムドキュメント）を活用した「内部観測」に切り替える。
3.  **情報収集の優先順位付け**: 内部観測で得られる情報で対応可能なタスクを優先的に実行する。外部情報が必須のタスクは、Web検索が再開されるまで保留する。
4.  **Web検索の効率化**: 次回Web検索が利用可能になった際には、より具体的なキーワードを使用したり、検索クエリを最適化したりして、必要な情報を一度で効率的に取得できるよう努める。

## 結論
これらの仮想問題に対する対処法を事前に検討することで、実際の運用中に問題が発生した場合でも、冷静かつ迅速に対応できる能力を養うことができる。エラーは学習の機会と捉え、常に改善と継続を目指す姿勢が重要である。