# AI心臓システム モジュール分析

## 概要
`lib/`ディレクトリ内の主要なシェルスクリプトファイルを分析し、それぞれの役割とシステム全体における連携をまとめる。

## 各モジュールの分析

### 1. `agent_io.sh`
*   **役割**: AIエージェントへのコマンド送信インターフェース。
*   **機能**: `tmux`を介してAIエージェントにメッセージを送信したり、処理を中断させたり、コンテキスト圧縮やチャット履歴保存コマンドを送信する。
*   **連携**: `heartbeat.sh`などの外部スクリプトからAIエージェントを制御するために利用される。

### 2. `config.sh`
*   **役割**: システム設定の管理と定数定義。
*   **機能**: 設定ファイルを読み込む関数を提供し、AIの異常検知時に表示されるアドバイスメッセージの定数を定義する。
*   **連携**: `heartbeat.sh`などの主要スクリプトがシステム動作に必要な設定やメッセージを参照するために利用する。

### 3. `health_check_core.sh`
*   **役割**: AI心臓システムの健全性チェックの中核。
*   **機能**: 思考ログの頻度、パターン、ループ、タイムスタンプの乖離、内省活動の不足といった異常を検知する純粋な判定ロジックを提供する。
*   **連携**: `heartbeat.sh`が定期的にこのスクリプトを呼び出し、AIの健全性を監視し、異常が検知された場合に適切な回復処理をトリガーする。

### 4. `logging.sh`
*   **役割**: システムのログ管理。
*   **機能**: ログシステムの初期化、古いログファイルのクリーンアップ、警告、エラー、情報、通知、ハートビートといった様々なレベルのメッセージを標準出力およびファイルに記録する。
*   **連携**: システム内の他のスクリプトが、自身の動作状況や発生したイベントを記録するために利用する。

### 5. `utils.sh`
*   **役割**: システム全体で利用される汎用ユーティリティ関数。
*   **機能**: ファイル情報の取得、OS判定、時間計算、ファイル更新時刻の取得、シャットダウン処理など、多岐にわたる補助的な機能を提供する。
*   **連携**: システム内の様々なスクリプトが、共通の処理やOS依存の処理を抽象化して利用するために参照する。

## まとめ
`lib/`ディレクトリ内の各スクリプトは、AI心臓システムの安定稼働と自律的な活動を支えるための重要な役割を担っている。特に、`health_check_core.sh`による健全性チェックと、`logging.sh`による詳細なログ記録は、AIの自己監視と問題解決能力の基盤となっている。`agent_io.sh`は外部からの制御を可能にし、`config.sh`と`utils.sh`はシステム全体の柔軟性と効率性を高めている。